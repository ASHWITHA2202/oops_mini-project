package ashwitha;
import java.io.*;
import java.util.*;

class Product implements Serializable {
    String id, name;
    int stock, reorderLevel;

    Product(String id, String name, int stock, int reorderLevel) {
        this.id = id;
        this.name = name;
        this.stock = stock;
        this.reorderLevel = reorderLevel;
    }

    boolean needsReorder() {
        return stock <= reorderLevel;
    }

    void showDetails() {
        System.out.println(id + " - " + name + " (Stock: " + stock + ")");
    }
}

public class InventoryFileDemo {

    public static void saveProducts(List<Product> products, String filename) {
        try (ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(filename))) {
            out.writeObject(products);
            System.out.println("\nProducts saved successfully to file.");
        } catch (IOException e) {
            System.out.println("Error while saving: " + e.getMessage());
        }
    }

    @SuppressWarnings("unchecked")
    public static List<Product> loadProducts(String filename) {
        List<Product> products = new ArrayList<>();
        try (ObjectInputStream in = new ObjectInputStream(new FileInputStream(filename))) {
            products = (List<Product>) in.readObject();
            System.out.println("Products loaded successfully from file.\n");
        } catch (FileNotFoundException e) {
            System.out.println("No existing file found. Starting fresh inventory.");
        } catch (IOException | ClassNotFoundException e) {
            System.out.println("Error while loading: " + e.getMessage());
        }
        return products;
    }

    public static void main(String[] args) {
        String filename = "inventory_data.ser";
        List<Product> products = loadProducts(filename);

        if (products.isEmpty()) {
            products.add(new Product("P101", "Mouse", 2, 5));
            products.add(new Product("P102", "Keyboard", 10, 5));
            products.add(new Product("P103", "Monitor", 3, 4));
        }

        System.out.println("Current Inventory:");
        for (Product p : products) p.showDetails();

        System.out.println("\nReorder Check:");
        for (Product p : products)
            System.out.println(p.name + " needs reorder? " + p.needsReorder());

        saveProducts(products, filename);
    }
}
